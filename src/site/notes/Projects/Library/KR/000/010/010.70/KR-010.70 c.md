---
{"dg-publish":true,"title":"CSV파서 만들어서 기능연동해보기","description":"CSV파서 만들어서 기능연동해보기","permalink":"/projects/library/kr/000/010/010-70/kr-010-70-c/","dgPassFrontmatter":true,"noteIcon":"0","created":"2025-08-03T23:56:41.053+09:00","updated":"2025-08-03T23:58:01.100+09:00"}
---

현재 노트: [[Projects/Library/KR/000/010/010.70/KR-010.70 c\|KR-010.70 c]] 
상위 분류: [[]] 


#Java #CSV #Swing #DataParsing #Troubleshooting

### ## [Java] 공공데이터 CSV 파싱 및 Swing UI 구현 - 트러블슈팅 기록

#### ### 프로젝트 개요

**목표:** 공공데이터 포털에서 제공하는 '지역 축제 정보' CSV 파일을 파싱하여 Java Swing UI에 표시하는 애플리케이션을 구현한다. **데이터 소스:** [문화체육관광부 전국 지역축제 개최계획](https://www.mcst.go.kr/kor/s_culture/festival/festivalList.jsp)

단순한 CSV 파싱 작업으로 예상했으나, 데이터의 비정형성으로 인해 여러 기술적 문제에 직면했다. 이 글은 그 해결 과정을 기록한 트러블슈팅 문서이다.

---

#### ### 1. 데이터 전처리: 파싱 이전에 필요한 작업

초기 CSV 데이터는 셀 병합, 여러 줄의 헤더, 불필요한 메타데이터가 포함되어 있어 프로그래밍으로 즉시 처리하기 어려운 상태였다.

**▼ 원본 CSV 헤더의 모습**

```
2025년 연간 지역축제 개최 계획,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
연번,광역자치단체명,기초자치단체명,축제명,축제 유형,개최 장소,,,,,개최기간,,,,,,,,개최 주기,개최 방식,"최초
개최연도",,예산(백만원),,,방문객수(前년),,,전담조직(축제사무국),,,"국비지원
부처명",담당,,
,,,,,장소명,축제 유형,지자체명,,,시작일,,,종료일,,,"총
일수",비고,,,,합계,국비,지방비,"기타
(민간)",전체, 내국인(명) ,외국인(명),전담조직명,조직형태,설립근거,,기관명,부서명,연락처
,,,,,,,시도,시군구,읍면동,년,월,일,년,월,일,,,,,,,,,,,,,,,,,,,
```

따라서 파싱 로직의 복잡성을 줄이기 위해, 프로그래밍에 앞서 다음과 같은 데이터 전처리 원칙을 세웠다.

1. **헤더 단일화**: 여러 줄로 나뉜 헤더를 분석하여, 프로그래밍에 사용할 단 한 줄의 명확한 헤더로 통합했다.
    
2. **컬럼 선택**: 모든 데이터가 필요한 것은 아니므로, 사용할 열을 미리 선별하고 나머지는 과감히 삭제했다.
    
3. **데이터 포맷 정리**: 줄바꿈이 포함된 셀(`"최초\n개최연도"`)이나 후행 쉼표 문제를 해결하여 데이터의 일관성을 확보했다.
    

---

#### ### 2. 애플리케이션 설계: 역할의 분리

파싱 로직과 UI 로직, 데이터 관리를 분리하기 위해 다음과 같이 계층을 나누어 설계했다. 각 계층의 역할을 명확히 하기 위해 '광산 채굴'을 메타포로 사용했다.

- **DTO**: 데이터 구조를 정의하는 **'광석(鑛石)'**.
    
- **Parser**: 원본 데이터를 DTO 형태로 가공하는 **'도구(道具)'**.
    
- **DAO**: Parser를 이용해 데이터 소스에서 DTO 목록을 가져오는 **'광부(鑛夫)'**.
    
- **Service**: DAO의 데이터를 조합/가공하는 **'세공사(細工師)'**.
    
- **View**: 최종 결과물을 사용자에게 보여주는 **'판매원(販賣員)'**.
    

---

#### ### 3. 파서 구현: 단계별 트러블슈팅

##### #### 3-1. 문제: 불필요한 후행 쉼표

엑셀에서 불필요한 열을 삭제했음에도, CSV 파일에 수많은 후행 쉼표가 남아있는 문제가 발생했다.

```
축제명,광역자치단체명,...,연락처,,,,,,,,,,,,,,,,,,,,,
춘천 감자페스타,강원,춘천시,...,033-250-3070,,,,,,,,,,,,,,,,,,,,,
```

- **원인**: 엑셀에서 `Delete` 키로 **'내용만 지웠기'** 때문이었다. 셀 서식이등