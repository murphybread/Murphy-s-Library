---
dg-publish: true
description: This article covers AWS 2024 seoul. Almost session related to AI, So I could free some trend of a cloud. The keyword was finance that mentioned may times. EKS kubernetes and token count etc...
---
#[[Projects/Library/000/000\|000]]#IT_Knowledge#[[Projects/Library/000/090/090\|090]]#External_Insights_an_Trends#[[Projects/Library/000/090/090.10/090.10\|090.10]]#Live_Session#[[Projects/Library/000/090/090.10/090.10 b\|090.10 b]]#AWS_2024_Summit
# Key Note



# 1일차
## 1F그랜드볼룸 11시10분-11시50분 우아한 형제들 컨테이너를 통한 데이터플랫폼혁신 #Trino #EKS #EMR #Airflow #Yunikorn

- 컨테이너로 데이터 처리하기
	- 고려요소
		- 인프라
		- 다양한 프레임워크
		- 데이터포맷
		- 테이터양 증가
		- 변화하는 비즈니스
	- 컨테이너 유연성
		- 이미지 기반 패ㅣ징
		- 유연한 자원확보
		- 데이터프로세싱
	- EMR on EKS
		- 하나의 EMR, 다수의 Pod
		- 워크로드에 필요한 이미지, 코드, 라이브러리, 프ㅕ레임워크를 컨테이너 이미지에 내장
		- EMRFS 및 S3를 데이터 저장소로 활용
		- Spark, Flink 지원
		- 장점
			- Karpenter를 활용한 유연한 컴퓨팅 자원
			- 다양한 EMR 워크로드들을 하나의 EKS 클러스터로 워크로드 통합
- 우형 데이터 플랫폼 소개
	-  데이터 로그 규모: 1TB (10억건), 디바이스 6M, 700+ airflow에서 deck, 쿼리엔진 4000개
- 컨테이너기반 데이터플랫폼 구축여정
	- 펜데믹 이후 약 5배이상 데이터의 급격한 성장, 식사시간의 경우 평소보다 급하게 증가하는 트래픽 패턴
	- EC2 기반 플랫폼의 한계
		- 비용 증가 (EC2사용 했었는데 오버프로비저닝)
		- 낮은 민첩성 (불규칙한 대량 트래픽, 자원 경합)
		- 어려운 유지보수 (**태스크별 의존성 주입**, 방화벽, EMR 업그레이드)
			- **Airflow의 관리가 제일 어려웠움** 모든 의존성을 해결한상태여야 submit이 되기 떄문
	- 이관 과정
		- 한계점 봉착
		- Airflow EKS클러스터로 이관: **Airflow는 의존성이 해결된 컨테이너를 실행해주는 역할만 해주는데 이를 통해 의존성문제가 크게 해결**
		- 데이터 처리 시스템 이관: Emr on EKS를 해보니 3배이상 퍼포먼스차이가남. 
		- 데이터 분석 도구, 서빙 API 이관:
	- 아키텍처 (이미지 유)
	- 개선효과
		- 비용 개선: 상시 운용 및 효율적 스케일링
		- 통합 자원 활용: 개발-배포 리드 타임 감소
		- 자원 격리: Pod기반 자원할당으로 간섭 여지가 없는 강력한 자원 격리
- 분석 고도화
	- 스케줄러 Apache Yunikorn 적용: 반복적인 VPC 서브넷의 고갈.
		- 데이터 로컬리티 최적화 부재
		- 빈 노드 활용 문제
		- 애플리케이션 자원 경합
		- 고급 스케줄링 (이미지 유)
			- Gang 스케줄링
			- Bin Packing
	- Airflow기반 셀프 서비스
		- 공용 개발 환경 문제점
			- DAG의존성 패키지 충돌, 데이터 오염
			- 브랜치 전략 저굥ㅇ 불가능
		- On- Demand 개인 전용 환경
			- Custom Resource rntjd
			- 사용자마다 개별 git branch sync로 개발중인 DAG 연동
	- Airflow Operator
		- 고도로 추상화된 작업
			- EMR Containers API 기반
			- Metric 기반 동적 자원 할당
		- 다양한 Transfer Operator wprhd
			- jdbcToSparkXOntainerOperator
			- SparkToSpartkContainerOperator
			- ...
	- 클러스터 설정 간소화
		- Job template API 적용. Id만 지정해서 사용(overwrite만 고려)
	- 모니터링 환경
		- Spark Histtory 서버
		- 로그 및 메트릭 수집
	- EMR 컨테이너 이미지 관리
		- 원하는 커스텀 이미지


## 3F 오디토리움 1시10분- 1시50분 넥슨의 LLM 에이전트 길들이기: 인프라 모니터링 서비스 적용 사례 
- 서바 저원 할당 최적화
- 이상 징후 탐지
- 자동화된 응답 시스템 구축

**백오피스 복잡성증가: 분산된 정보를 서로 연결해서 볼 수 있는 방법이 없을까?**
최신화, 담담자 정보, 이슈를 빠르게 한 번에 조회하고 싶다.

Nexon의 목표 -> 이상적 목표는 Javis , 현실적 목표는 Protorype

## 소개
구현 범위
- 서버의 Metric중심 Metric 데이터는 서비스가 달라도 포맷 동일
- 서비스맵 활용
- LLM 챗봇 형태

잘된 것
- 질문-답변 구조 챗봇생성과 API연동
- 주말 Metric을 그래프로표현
- 이슈 정보와 Metric 데이터 연결다볍
- 품질개선

잘 안 된것
- 사용자의 눈높이를 맞추지 못함
- 서비스간 연동 정보 보완 필요

핵심 이슈
- 담변 품질이슈: 속도+정확도+비용 2분30초 환각 50원 -> 30초 확인 30원

## 구현
키 컨셉: Enablement
1. 챗봇 준비사항
	- 데이터간 연결고리는 자동 확보
		- LLM의 추론능력 활용
	- 변경된 정보는 즉시 반영
		- Claude, LLama등 활용
	- 응답형태는 자유로워야 한다(자연어, 리스트, 그래프)
1. ReAct 프롬프팅
	1. 생성, 주입 등 반복 여부 결정
	2. 예제
		1. 넥슨 로그인 서비 담당자가 누구야
		2. 넥슨웹 서비스 CPU사용량 알려줘
2. 이슈 및 해결
	1. Latency Token 증가, 환각도 증가
	2. 반복 빈도 최소화, 모델 분리 검토
	3. 역할별 임무뷰어
		1. Multi Agents
		2. @mention, Return Direct, `#N Agents`
	4. 계획적 업무수행
		1. Plan and Execute
	5. 작업 단위로 분할
		1. Task Tools
	6. 추가 기술 검토
		1. Intent 분석
		2. Slot Filling
		3. Stream
3. 요약 및 결론




## 3F 오디토리움 3시20분- 4시00분 샌드버드의 생성형 AI 기반 글로벌 Chatbot 서비스

센드버드 나만의 생성형 AI 챗봇

- Prompt Engineering
	- Prompt History
- Knowledge Base
	- Knowledge management
- No-code Widget


- UI
- Orchestration
- Prompt Engineering
- Embedding
- Model
- Runtime
- Infrastructure
Life Cycle이 유지돼야 한다

AI 챗봇의 어려움
- 안정성
- 정보보호
- 통합
- 맞춤설정
- 확장성
- 품질


Pinecon에서 Amazon OpenSearch Service로 Vector DB변경
- 효율적인 document
- index별 독립적인 설정 가능
- Hybrid지원(70%->90%)





## 1F그랜드볼룸 5시20분-6시00분 삼성전자의 AI 기반 SmartThings 인텔리전스 플랫폼


# 2일차
# 키노트

Rust 언어 추천

인프런 약 연간 비용4억 줄임
- RDS 많이쓰는데 타입 낮추면 비용절반
- 인스턴스 타입
- 시스템을 비지니스 운영원칙에 맞춰라

추가 팁
CFRC 계약. 트래픽에 대한 할인
서버 vs 서버리스: 24시간 기반은 서버, 일정 시간은 서버리스
회사데이터 대쉬보드와 비용 대쉬보드를 통해 합리적인 인사이트



생성형 AI
- 다양한 모델을 쓰는게 좋음. 가격 떄문임.  가장비싼거로 시작후 프로덕션레벨로 들어가면 큰 부담임
- workflow의 개념이 중요해짐. 기존은 Prompt나 RAG의 컨텍스트에 집중하는데, 결국복잡해진 인풋 아웃풋을 목표로하게 됨
- fine-tuning이 얼마나 필요한 것이냐. 많은 경우 PoC를 먼저 시작하는데 퀄리티가 좋은편이라 의료같은 특정 도메인이 아니라면 안해도 된다고 생각




## 3F 오디토리움 11시10분~11시50분 개발의 미래: AWS AI 도구로 시간 절약하기

AWS 아키텍트 2분


### 어려움
1시간 미만의 코딩
73% 어플관리 27% 창의적 개발

라이프사이클
- 계획
- 작성
- 테스트 & 보안
- 운영
- 유진관리 & 현대화


### 솔루션
Amazon Q Busniess

Amazon Q Developer
- AWS 콘솔
- IDSs
- AWS 문서
- AWS 콘솔 모바일 앱
- Slack and Team
- Amazon CodeCatalyst
탐색
- 17년동안 축적된 AWS 지식, 모범사례, 아키텍처 최적화
- 여러분의 데이터를 활용한 비지니스 전문가
작성
- 코드생성
- 코드 설명
- 코드베이스에 대한 이해
- 코드에 맞게 커스터마이징 (레포 학습)
테스트 & 보안
- 단위 테스트 생성
- 보안 취약점 스캔
- 품질 향상을 위한 개선책 생성
운영
- AWS 콘솔에서 오류 진단 및 문제 해결
- 네트워크 연결성 및 VPC 접근성 분석
- AWS 계저엥 있는 리소스 확인 및 가이드 받기
유지관리 & 현대화
- 언어 버전을 현대화
- 코드 업그레이드 및 변환의 전체 프로세스 자동화


데모
- 가상 시나리오
	- java 지원 종료
	- 개발자가 수년 나감
	- python 경험 없는 개발자
	- 구현해야하는 기능이 남아있음
- 먼저 JAVA 17로 업그레이드 하면 좋겠어요
	- `/transform`
	- 3스텝 디펜던시, java17로변환 후 이슈확인, 제안 사항 확인
	- 빌드된 부분 확인, pom.xml의 버전 수정, 함수의 deprecated된 부분 수중
- 테스트 범위를 넓히는 작업을 해보는 게 어떨까요?
	- 블럭 선택 후 우클릭
- Javadoc 주석을 추가하여 코드의 API 보완
	- `/dev` javadocs 를 해줘특정 메소드들에대해 주석 달아줘
	- code diff 확인가능
	- accept code시 적용 됨
- Lambda에 문제가 생겼네요
	- 람다에서 문제가생긴걸 테스트하고
	- Amazon Q버튼클릭
	- 람다권한이 없다는 문제파악 후, 해결방법 보기
- 마침내 새로운 기능을 추가할 수 있겠네요
	- 주석으로 작성된 제곱함수에 자동완성
	- 메소드의 주석까지도 자동으로 생성됨, 내부 코드를 참고하기 떄문
- 더 많은 작업을 요청해 볼까요?
	- 아마존 카탈리스트. title과 description작성 후 Amazon Q에 할당
- 운병비용 시각화
	- quick sight를 통해 대쉬보드 시각화 가능







## 3F E홀 1시10분- 1시50분 AWS 벡터 데이터베이스의 벡터데이터사용 모범사례 

- 생성형 AI 개요 데이터베이스의 역할
- 벡터 저장소로의 PsotgreSQL
벡터의 과정
- 임베딩을 생성하는 시간
- 임베딩의 크기
- 1536 dimensions, 4byte 부동소수점, 1백만건 5.7GB 6152B=>6KiB
- 쿼리 시간

벡터 저장 시스템 선택에 관한 질문
- 나의 워크플로우에서 벡터 저장소는 어디에 적합한가요?
- 나는 얼마나 많은 데이터를 저장하고 있나요?
- 스토리지, 서능, 연관성, 비용 중 나에게 중요한 것은 무엇인가요?
- 인덱싱, 쿼리 시간, 스키마 디자인 등 장단점은 무엇인가요?
pgvector란?
- PostgreSQL의 확장기능
- 스토리지, 인덱싱(IVFFlat 인버티드 플랫, HNSW 그래프 기반), 검색 (K-NN, ANN, 메타데이터(임베딩하여 공동 배치) 및 선택 가능한 거리(<->, <=>,<#>)
pgvecotr 전략 및 모범사례
- 스토리지 전략
	- PostgrSQL의 TOAST의 이해(Tre Oversized-Attributed Storager Tequnique)
	- 최소 크기 이상의 단위가 있다. 만약 2KB초과의 데이터를 다르게 저장
	- 510 디멘전 4바이트 부동 소수점벡터는 TOAST가 됨
	- 컬럼 스토리지 타입
		- PLAIN타입: 테이블에 인라인으로 데이터 저장
		- EXTENDED 임계값 초과 시 TOAST 테이블에 데이터가 저장 압축됨(Default)
		- EXTERNAL: 임계갑...
		- MAIN: 인라인인데 압축함
	- TOAST의 형향
		- 128디멘전 6개의 워커노드
		- 1536 디멘저 4개의 워커노드(NO TOAST전략), TOAST 전략 사용후 워커노드11개
	- TOAST 전략
		- PLAIN 스토리지 사용
			- ALTER TABLE ... ALTER COLUMN ... SET STORAGE PLAIN
			- 데이터가 존재하는 경우 테이블 재생성 필요
			- 벡터 크기를 2000디멘전으로 제한
			- min_parallel_tabel_scan_size를 사용하여 더 많은 병렬도 유도
- HNSW 전략
	- m
		- 인덱스된 벡터간의 최대 양방향 링크 수
		- 기본 값 16
	- ef_construction
		- 최근접 이웃 목록에 유지해야할 벡터 수
		- 기본값 64
	- 구축
		- 낮은 레이어에서 점점 밀도가 높아지는 레이어로 링크 만듬(레이어3->2->1->0)
		- 같은 레이어에서 링크를 만듬
	- hnsw.ef_search
		- 최근접 이웃 목록에 유지해야할 벡터 수
		- LIMIT보다 반드시 크거나 같아야함
	- 쿼리
		- 점점 밀도가 높은 레이어로 이동하면서 그 중 유사한 노드로 이동
	- 개요 요약
		- HNSW는 인덱스 구축에 있어 더 많은 선행 작어블 수행
		- 검색 결과 내 가장 가까운 이웃에 대하
	- 모범사례
		- 기본값 (M=16 , ef_construction=64)은 일반적으로 잘 잗동함
		- 빈인덱스로 시작하여 동시쓰기를 하는게 가장 빠른 구축 방법
	- M은 속도에 더 영햐을 줌
	- 성능 전략
		- 인덱스 구축은 성능 재현율에 가장 큰 영향을 미침
		- hnsw.ef_search 를 늘리면 재현율은 증가하고 성능은 감소
- IVFFlat 전략
	- 인덱스 구축 리스트 할당
	- 인덱스 쿼리
		- porbes라는 변수 사용
	- 쿼리에 대한 성능 전략
		- ivfflat.probes를 늘리면 재현율은 증가하고 성능은 감소
		- 쿼리별로 random_page_cost 를 낮추면 인덱스 사용이 유도됨
		- 메모리에 데이터를 유지하는 값인 shared_buffers 설정
		- 쿼리별로 work_mem을 늘림
	- 구축 모범 사례
		- 재현율을 최대화하지만 검색 노력을 최소화하려면
		- 적절한 리스트 값을 선택
			- 백만 건 기준
		- 인덱스에 벡터를 추가/수정할 때 다시 구축해야할 수도 있음
	- 병렬성을 사용하여 구축 시간 단축
	- IVFFlat에서 병렬처리가 작동하는 방식
		- 센터찾기
		- 벡터를 센터에 할당
			- 테이블 내 백터
			- 순차스캔
			- 리스트에 할당
			- 리스트
		- ...
		- ...
	- 
- pgVecto 필터링 전략
	- WHERE 조건
	- 필터링이 ANN쿼리에 미치는 영향
		- PostggreSQL은 읻겟를 사용하지 않도록 선택할 수 있음
		- 인덱스를 사용하지만 충분한 결과를 반환하지 않음
		- 인덱스를 사용한 후 필터링이 발생
	- 필터링 전략
		- 부분 인덱스
		- 파티션
		- 기존 임베딩으로 필터링
결론
- 쿼리성능과  재현율
- 스토리지, 컴퓨팅, 인덱싱 전략


## 3F 오디토리움 3시20분-4시00분 Amazon Bedrock을 활용한 프롬프트 엔지니어링 모범사례 L
프롬프트 엔지니어링
- 단순
	- 페르소나
	- 원샷 프롬프팅
	- 퓨샷 프롬프팅
- 고급
	- CoT
	- RAG 

프롬프트를 자주 테스트하고 반복하기 TDD
1. 테스트 케이스 작성. 엣지 케이스 필수
2. 프롬프트 초안 작성
3. 테스트케이스로 검증 <<<
4. 프롬프트 수정           >>>
5. 공유

명확하고 직접적으로 표현하기



1.  User: 롤 설명
2. 작업 컨텍스트
3. 처리할 배경 데이터
4. 세부 작업 설명 및 규칙
5. 예시 2개이상
6. 단계별로 생각하기
7. 출력양식
8. assistant: